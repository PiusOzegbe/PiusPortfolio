---
import { getCollection} from "astro:content";
import "../../styles/global.css";

export async function getStaticPaths() {
	const posts = await getCollection("blog");
	return posts.map((post) => ({ params: { slug: post.slug }, props: { post } }));
}

let { post } = Astro.props;

if (!post) {
	return new Response(null, {
		status: 404,
		statusText: "Not Found",
	})
}

let {
	data: { title, description: desc, keywords, date },
} = post;
const { Content } = await post.render();

if (!title) title = "Ayodeji";
if (!desc) desc = "A portal into my thoughts, thoughts, experiences, ideas, visions, and more. What's the point of this? Well, I'm not sure, but here you go anyhow.";
if (!keywords) keywords = "ayodeji, osasona, trulyao, ayo, developer, engineer, php, python, java, c++, node, typescript";

const formattedDAte = new Date(date).toLocaleString("en-US", { dateStyle: "long" });
const metaRawUrl = new URL("https://og.wyte.space/api/v1/images/trulyao/preview");
metaRawUrl.searchParams.append("variant", "blog");
metaRawUrl.searchParams.append("style", "blog");
metaRawUrl.searchParams.append("size", "medium");
metaRawUrl.searchParams.append("vars", `title:${title},date:${formattedDAte}`);

const metaUrl = metaRawUrl.href;

---

